<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"> <html><!--
 Page saved with SingleFile 
 url: https://cw.felk.cvut.cz/brute/data/ae/release/2019z_b4m33pal/pal2019/evaluation/input.php?task=lcgprevnum 
 saved date: Sat Jan 18 2020 11:47:39 GMT+0100 (Středoevropský standardní čas)
--><meta charset=utf-8>
<meta http-equiv=cache-control content=no-cache>
<title>Problem Assignment BM33PAL</title>
<meta http-equiv=cache-control content=no-cache><title>Programming assignment A4M33PAL</title><link type=image/x-icon rel="shortcut icon" href="data:image/vnd.microsoft.icon;base64,AAABAAEAEBAAAAAAAABoBQAAFgAAACgAAAAQAAAAIAAAAAEACAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAABoZ2cA+fn5AOrq6gArKysA29vbAHV0dADo6OgA6ejoANnZ2QC7u7sArKysAJ2dnQB/f38Aubm5APPz8wCMjIwA5OTkAG5ubgDGxsYAt7e3AEJBQQCKiooA4uLiACMjIwDExMQA/v7+AO/v7wAiISEAXFtbAE1MTACWlZUALy4uAGhoaADAwMAAaWhoALGxsQDr6+sAhISEANzc3AAeHR0Azc3NAGZmZgBISEgAoKCgAPj4+ACRkZEA6enpANra2gDLy8sAvLy8AFZVVQA3NzcAODc3AI+PjwDn5+cA2NjYAMnJyQALCgoAurq6ADY1NQDl5eUA1tbWALi4uABDQkIA4+PjACUkJADU1NQAxcXFAP///wDw8PAA4eHhAHp6egB7enoA0tLSANPS0gDEw8MAh4eHAHh4eACysrIATEtLAJSUlADd3d0Ad3Z2AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACVFRUVFRUUZAUVFARlFRISZEREREREQWMEREQgREREY3RERERERETD9ERB1IRERRN0RERERERE8zRgYbKQFEUTdERERERBAfIysVAB5LRFE3REREREQLFBlSJzhDDERRN0REREQBOxEZBTkONjQGFjdEREQBKCVOLBINDiYPSUA3RDwgHEc1CERERERERERRURoXIiQZRRpEREREREREUS4tQURERERERERERERERFECTTJERERERERERERERERRQBgDRUREEEpEREREREREUTdEUCI+TioKRERERERERFEmREQHGDE6PUREREREREQWEzc3URZAFi83Nzc3Nzc3CQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA="></head>
<body>
 
 
 
 
 <div class=main>
<h2><font color=blue>Missed value generated by an unknown LCG</font></h2>
<p align=justify>
</p>
Let a <i>linear congruential generator</i> (LCG) of the form
<i>x</i><sub><i>i</i>+1</sub>=(<i>A</i><i>x</i><sub><i>i</i></sub>+<i>C</i>) mod <i>M</i>
be represented by the triple (<i>A</i>, <i>C</i>, <i>M</i>).
<br><br>
An LCG printed out three consecutive numbers, but you missed the first one. Is there a way to determine a set of possibilities for the missed number
when you have some little information about the generator?
<h3><font color=blue>The task</font></h3>
<p align=justify>
Given positive integers <i>M</i>, <i>X</i><sub>2</sub> and <i>X</i><sub>3</sub>, determine for which integers <i>X</i><sub>1</sub> there is
at least one LCG (<i>A</i>, <i>C</i>, <i>M</i>) such that
<ul>
<li>its period length is <i>M</i>,</li>
<li>2 ≤ <i>A</i> ≤ <i>M</i>,</li>
<li>1 ≤ <i>C</i> ≤ <i>M</i>,</li>
<li>the generator generates <i>X</i><sub>1</sub>, <i>X</i><sub>2</sub>, <i>X</i><sub>3</sub> as three consecutive numbers.</li>
</ul>
<p><h3><font color=blue>Hint</font></h3>
<p align=justify>
You might need a procedure solving a linear congruence, i.e., the problem of finding an integer <i>x</i> satisfying
<i>ax</i> ≡ <i>b</i> (mod <i>m</i>)
for specified integers <i>a</i>, <i>b</i>, and <i>m</i>.
An efficient solution for the case when GCD(<i>a</i>,<i>m</i>)=1 is described <a href=http://wrean.ca/cazelais/linear_congruence.pdf>here</a>.
The solution is based on
<a href=https://en.wikipedia.org/wiki/Extended_Euclidean_algorithm#Computing_multiplicative_inverses_in_modular_structures>multiplicative inverses</a>.
</p>
<hr>
<h3><font color=blue>Input</font></h3>
<p align=justify>
The input consists of one line containing integers <i>M</i>, <i>X</i><sub>2</sub>, <i>X</i><sub>3</sub> separated by spaces. 
<br>
It holds that 3 ≤&nbsp; <i>M</i> &nbsp;≤&nbsp; 3.2 × 10<sup>7</sup>.
<h3><font color=blue>Output</font></h3>
<p align=justify>
The output is one line containing integers <i>N</i>, <i>X</i><sub>min</sub>, <i>X</i><sub>max</sub> separated by spaces. 
Output <i>N</i> is the number of values for which there is at least one feasible LCG generating the value right
before the pair <i>X</i><sub>2</sub>, <i>X</i><sub>3</sub>. Output <i>X</i><sub>min</sub> is the minimum of the set of the considered <i>N</i> values.
Analogously, output <i>X</i><sub>max</sub> is the maximum of the set of the considered <i>N</i> values.
<br>
It is guaranteed that at least one feasible LCG exists, i.e., <i>N</i> ≥ 1.
</p>
<h3><font color=blue>Example 1</font></h3>
<b>Input</b><br>
<pre>8 2 1
</pre>
<b>Output</b><br>
<pre>1 7 7
</pre>
(5, 7, 8) is the only feasible LCG. It generates the sequence 0, 7, 2, 1, 4, 3, 6, 5 in which the subsequence 2, 1 is preceded by number 7.
<h3><font color=blue>Example 2</font></h3>
<b>Input</b><br>
<pre>9 7 3
</pre>
<b>Output</b><br>
<pre>2 5 8
</pre>
There are two feasible LCGs for which number 3 is generated after number 7. These LCGs are (4, 2, 9) and (7, 8, 9).
The first one generates the sequence 0, 2, 1, 6, 8, 7, 3, 5, 4, while the second one generates
the sequence 0, 8, 1, 6, 5, 7, 3, 2, 4.
<h3><font color=blue>Example 3</font></h3>
<b>Input</b><br>
<pre>48 32 15
</pre>
<b>Output</b><br>
<pre>3 13 37
</pre>
<hr>
<h3><font color=blue>Public data</font></h3>
<p align=justify>
The public data set is intended for easier debugging and approximate program correctness checking. The public data set is stored also in the upload system and each time a student submits a solution it is run on the public dataset and the program output to stdout and stderr is available to him/her.
<br>
<a href="https://cw.felk.cvut.cz/brute/data/ae/release/2019z_b4m33pal/pal2019/evaluation/getdata.php?task=lcgprevnum&amp;item=datapub.zip"><b>Link to public data set</b></a>
</p>
</div>
